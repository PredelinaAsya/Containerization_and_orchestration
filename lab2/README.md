# Лабораторная работа №2

## Содержимое docker-compose

Для запуска достаточно собрать образы с помощью
```sh
docker-compose build
```
И запустить сервисы c помощью
```sh
docker-compose up
```

Проект состоит из четырех сервисов:
- скрипт инициализации БД. Сервис собирается из отдельного докерфайла db_init.Dockerfile и запускает bash-скрипт, который может проинициализировать БД, создать нужные таблицы и т.д.. Для демонстрации он просто печатает текст.
- MongoDB - выбранная БД, от которой зависит основной сервис. Использует порт 27017.
- Mongo-express - UI для взаимодействия с монгой, поднимается на порте 8081.
- непосредственно сам сервис с jupyter lab, поднимается на настраиваемом переменой окружения порте. Настроен healthcheck.

В файле .env настраиваются переменные окружения - данные для root пользователя MongoDB и порт для основного сервиса с Jupyter.

База MongoDB и файлы из jupyter маунтятся в локальные volume на хосте.

## Ответы на вопросы

### 1. Можно ли ограничивать ресурсы (например, память или CPU) для сервисов в docker-compose.yml? Если нет, то почему, если да, то как?

Да.
Существует два варианта установки ограничения на память и CPU. Первый, для версии 2 и выше:
```yaml
version: '2'

services:
  my_service:
    mem_limit: 512m          # ограничение на использование памяти
    mem_reservation: 256m    # резервирование памяти
    cpus: '0.5'              # ограничение на использование CPU
```

В версии 3 и выше доступна следующая конфигурация:

```yaml
version: '3.8'

services:
  my_service:
    deploy:
      resources:
        limits:
          cpus: '0.5'        # ограничение на использование CPU
          memory: 512M       # ограничение на использование памяти
        reservations:
          cpus: '0.25'       # резервирование CPU
          memory: 256M       # резервирование памяти
```

Но для ее использования необходимо swarm mode и команду docker stack deploy.

### 2. Как можно запустить только определенный сервис из docker-compose.yml, не запуская остальные?

Для этого достаточно указать имя сервиса после команды ```docker-compose up```:
```sh
docker-compose up my_service
```

Это также запустит все необходимые зависимости этого сервиса.
